# Overview
### Dependencies
Ensure the following R packages are installed before running the script:
```
install.packages("data.table")
install.packages("stringr")
install.packages("susieR")
install.packages("coloc")
```
## Finemapping
### Usage
 ```
Rscript finemapping_analysis.R <variant> <summ_file> <ld_file> <lower> <upper> <chromosome>
 ```
### Arguments
 - ```variant ```: SNP ID of the variant of interest
 - ```summ_file ```: Path to the GWAS summary statistics file
 - ```ld_file ```: Path to the LD matrix file (generated by plink)
 - ```lower```: Lower bound (bp) for the region to analyze
 - ```upper```: Upper bound (bp) for the region to analyze
 - ```chromosome```: Chromosome number of the variant
#### summ_file should contain the following columns:
 - ```SNP```: SNP ID in chr:pos:ref:alt format
 - ```allele1```: Effect allele (alt)
 - ```allele2```: Other allele (ref)
 - ```b```: Effect size estimate for effect allele
 - ```se```: Standard error
 - ```N```: Sample size
### Output
The script generates credible sets for the variant of interest, saved with suffix```_credible_set_susieR_results.txt```
## Colocalization
This script performs credible set extraction and colocalization analysis for a variant of interest using GWAS and eQTL summary statistics. The results include credible sets, colocalization probabilities, and identified variants.
### Usage
```
Rscript coloc_analysis.R <variant> <summ_file> <ld_file> <lower> <upper> <chromosome> <coloc_prob>
 ```
### Arguments
 - ```variant ```: SNP ID of the variant of interest
 - ```summ_file ```: Path to the GWAS summary statistics file
 - ```ld_file ```: Path to the LD matrix file (generated by plink)
 - ```lower```: Lower bound (bp) for the region to analyze
 - ```upper```: Upper bound (bp) for the region to analyze
 - ```chromosome```: Chromosome number of the variant
 - ```coloc_prob```: colocalization probability threshold
#### summ_file should contain the following columns:
 - ```SNP```: SNP ID in chr:pos:ref:alt format
 - ```allele1```: Effect allele (alt)
 - ```allele2```: Other allele (ref)
 - ```b```: Effect size estimate for effect allele
 - ```se```: Standard error
 - ```N```: Sample size
### Output
The following suffixes are used for output files:
#### Credible Sets:
- GWAS credible sets: ```_credible_set_gwas.txt```
- eQTL credible sets: ```_credible_set_eqtl.txt```
#### Colocalization Results:
-  Summary of colocalization results: ```_coloc_credible_set_summary.txt```
-  Variants within credible sets that reach colocalization probability: ```_coloc_all_SNPs.txt```
